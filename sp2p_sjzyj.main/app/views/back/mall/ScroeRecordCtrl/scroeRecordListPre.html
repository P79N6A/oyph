#{extends 'common/back/mallMain.html' /}
#{set title:'积分商城 | 积分兑换记录' /}
#{set smallclass:1 /}
#{set crumbs:'积分商城 >积分兑换记录'/}
<div class="back-main">
	<!-- 头部筛选条件 -->
	<div class="back-usertop">
		<!-- 搜索按钮，控制搜索条件的显示隐藏 -->
	</div>
			<div class="back-search-option" >
		<form action="@{back.mall.ScroeRecordCtrl.scroeRecordListPre()}" method="GET" id="submit">
			<input type="hidden" id="currPage" name="currPage"/>
	  		<input type="hidden" id="pageSize" name="pageSize" value="${pageBean?.pageSize}"/>
	  		<input type="hidden" id="exports" name="exports"/><!--是否导出  -->
			<input type="submit" class="bgbtn" value="搜索" />
		</form>
	</div>
	<div class="back-cont">
		<div class="back-box">
			<table width="100%" class="back-table table-fixed">
				<tr height="40">
					<th width="70" class="align-left">
						<span class="back-order">
							序号
						</span>
					</th>
					<th>时间</th>
					<th>
						<span class="back-order">
						    会员名
						</span>
					</th>
					<th>积分</th>
					<th>兑换数量/投资金额</th>
					<th>事件</th>
					<th>状态</th>
					<th>备注</th>
				</tr>
			#{if page?.page}
				#{list items:page.page, as:'content'}
				<tr height="40">
					<td class="align-left">
						<label><input type="checkbox" class="back-tdcheck" />${(page?.currPage-1)*page?.pageSize + content_index}</label>
					</td>
					<td data-title="">
					${content?.time?.format('yyyy-MM-dd HH:mm:ss')}
					</td>
					<td>
						${content?.user_name}
					</td>
					<td>
					#{if content?.scroe > 0}+#{/if}${content?.scroe}
					</td>
					<td>
						${content?.quantity}#{if content?.type == 3}元#{/if}#{if content?.type == 5}个#{/if}
					</td>
					<td>
						${content?.description}
					</td>
					<td>
					#{if content?.type == 5}消费#{/if}#{else}赠送#{/else}#{if content?.status == 1}成功#{/if}#{else}中#{/else}
					</td>
					<td>
					<a  href="javascript:void(0)" onclick="addressDetails('${content?.remark}')">详情</a>
					</td>
				</tr>
				#{/list}
				<!-- 表格数据统计 -->
					<tr height="40">
									<td colspan="8" class="back-lasttd">
										<!-- 分页组件--pageTag -->
										#{backPageTag page:page,showPage:"showPage"/}
									</td>
								</tr>
			#{/if}
			#{else}	
					<!-- 暂无记录 -->
					<tr height="58">
						<td colspan="10" class="back-nodata"><i class="iconfont">&#xe613;</i>暂无记录</td>
					</tr>
				</table>
			#{/else}
		</div>
	</div>
</div>


<script type="text/javascript">
  $(function() {
	  var orderType = "${page?.conditions?.orderType}";
	    $("#orderType").val(orderType);
	    var orderStatus = "${page?.conditions?.orderStatus}";
	    $("#orderStatus").val(orderStatus);
	    var order = $("#div_" + orderType);
		
	    /* 初始为默认搜索 */
		if(orderType == ''){
			$("#div_0").attr("class", "xf_sea_isshow");
		}else {
		  order.attr("class", "xf_sea_isshow");
		  if(orderStatus == 1){
		     $("#sp"+orderType).html("↑");
		  }else{
		    $("#sp"+orderType).html("↓");
		  }
		}
  })
  
  function search(type){
    $("#isExport").val(type);	
    $("#submit").submit();
  }
  
  function showPage(currPage, pageSize){
    $("#currPage").val(currPage);
    $("#pageSize").val(pageSize);
    $("#submit").submit();
  }
  
   function conditonSearch(order){
	   var orderStatus = "${page?.conditions?.orderStatus}";
	   var orderType = "${page?.conditions?.orderType}";
		
		if(orderStatus == 1 && orderType == order){
			$("#orderStatus").val(0);
		}else{
			$("#orderStatus").val(1);
		}
		
		$("#orderType").val(order);
		$("#submit").submit();
   }
   
   function addressDetails(a){
		  alert(a);
	}
</script>
  </div>
</div>

