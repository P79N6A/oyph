#{extends 'common/back/teamMain.html' /}
	#{set title:'团队长| 推广规则设置' /}
	#{set smallclass:3 /}
	#{set crumbs:'团队长>推广规则设置'/}
<div class="back-main">
	<div class="back-cont">
		<div class="back-infor tglv" style="display:none;">
			<form action="@{back.team.TeamCtrl.editTeamRule()}" method="POST" id="seo">
				#{authenticityToken /}
				<input type="hidden" name="imgChanged" value="0"/>
				<h2 class="back-infor-head">
					<span class="left">推广会员提成计算</span>
					<a href="javascript:void(0);" class="right iconfont finance-edit" data-title="编辑" >&#xe602;</a>
				</h2>
				<ul class="back-infor-set">
					<li>
						<div class="liright">
						<input type="hidden" class="width01 iffocus" name="minAmount1" id="minAmount1" value="0" /> 低于<input type="text" style="width: 50px;" class="width01 iffocus" name="maxAmount1" id="maxAmount1" value="${lists?.get(0).maxAmount}" />万:提成=投资<input type="text" style="width: 50px;" class="width01 iffocus" value="${lists?.get(0).amount}" name="amount1" id="amount1" />% </br>
						</div>
					</li>
					<input type="hidden" name="customer_commission" id="customer_commission" >
					<li>
						<div class="liright">
						<input type="text"   style="width: 50px;" class="width01 iffocus" name="minAmount2" id="minAmount2" value="${lists?.get(1).minAmount}" />万~~<input type="text" style="width: 50px;" class="width01 iffocus" name="maxAmount2" id="maxAmount2" value="${lists?.get(1).maxAmount}" />万:提成=投资<input type="text" style="width: 50px;" class="width01 iffocus" name="amount2" id="amount2" value="${lists?.get(1).amount}" />%</br> 
						</div>
					</li>
					<li>
						<div class="liright">
						<input type="text" class="width01 iffocus" style="width: 50px;" value="${lists?.get(2).minAmount}" name="minAmount3" id="minAmount3" />万~~<input type="text" style="width: 50px;" style="width: 50px;" class="width01 iffocus" name="maxAmount3" id="maxAmount3" value="${lists?.get(2).maxAmount}" />万:提成=投资<input type="text" style="width: 50px;" class="width01 iffocus" name="amount3" id="amount3" value="${lists?.get(2).amount}" />%</br> 
						</div>
					</li>
					<li>
						<div class="liright">
						<input type="text" class="width01 iffocus"  style="width: 50px;" name="minAmount4" id="minAmount4" value="${lists?.get(3).minAmount}" />万~~<input type="text" style="width: 50px;" class="width01 iffocus" name="maxAmount4" id="maxAmount4" value="${lists?.get(3).maxAmount}" />万:提成=投资<input type="text" style="width: 50px;" class="width01 iffocus"  name="amount4" id="amount4" value="${lists?.get(3).amount}" />%</br> 
						</div>
					</li>
					<li>
						<div class="liright">
						<input type="text" class="width01 iffocus" style="width: 50px;" name="minAmount5" id="minAmount5" value="${lists?.get(4).minAmount}" />万~~<input type="text" style="width: 50px;"  class="width01 iffocus" name="maxAmount5" id="maxAmount5" value="${lists?.get(4).maxAmount}" />万:提成=投资<input type="text" style="width: 50px;" class="width01 iffocus" name="amount5" id="amount5" value="${lists?.get(4).amount}" />%</br> 
						</div>
					</li>
					<li>
						<div class="liright">
						<input type="text" class="width01 iffocus" style="width: 50px;" name="minAmount6" id="minAmount6" value="${lists?.get(5).minAmount}" />万~~<input type="text" style="width: 50px;" class="width01 iffocus" name="maxAmount6" id="maxAmount6" value="${lists?.get(5).maxAmount}" />万:提成=投资<input type="text" style="width: 50px;" class="width01 iffocus" name="amount6" id="amount6" value="${lists?.get(5).amount}" />%</br> 
						</div>
					</li>
					<li>
						<div class="liright">
						<span class="">被推广人理财手续费折扣:</span><input type="text" name="financial_fee" id="financial_fee" class="width01 iffocus" style="width: 50px;" value="${settings?.get(common.constants.SettingKey.FINANCIAL_FEE)}" />%
						</div>
					</li>
				</ul>
				</form>
		</div>
			<!-- lihuijun begin：---------------------------------------------->
		<div class="back-cont" style="padding-top: 0px;">
		<a href="@{back.team.TeamCtrl.definedTeamRulePre()}" onmouseover="this.style='color:#1e699e;'" onmouseout="this.style='none;'">自定义提成规则</a>
		
		<div class="back-infor">
			<form action="@{back.team.TeamCtrl.editTeamRule()}" method="POST" id="zslv">
				#{authenticityToken /}
				<input type="hidden" name="imgChanged" value="0"/>
				<h2 class="back-infor-head">
					<span class="left">推广会员资金年化折算</span>
					<a href="javascript:void(0);" class="right iconfont finance-edit" data-title="编辑" >&#xe602;</a>
				</h2>
				<ul class="back-infor-set" id="annualRate">
					
					<li>
						<div class="liright">
						理财期限<span class="gai1">折算率</span><span class="gai2">计算举例说明</span> <a id="zengj" style="float: right;display: none" href="javascript:addRow()"><i class="iconfont">&#xe60f;</i>添加一行</a></br> 
						</div>
					</li>
					#{set count:1/}
					#{list lists8, as:'adr'}
					<li id="${adr.timeLimit}+a" style="width:830px;" >
						<div class="liright">
							<input type="text" style="width: 20px;" class="qixian width01 iffocus" value="${adr.timeLimit}" />个月
							<input type="text" style="width: 35px;margin-left: 35px" class="zhesuan width01 iffocus" value="${adr.discountRate}" />%
							<span style="width: 200px;margin-left: 70px" class="width01 iffocus"/>1万元*${adr.discountRate}%=${adr.getSum()}元</span>&nbsp;
							#{if count>2}<span class="delZhe" onclick="delRow('${adr.timeLimit}+a')" style="display:none; cursor: pointer; float: right; ">删除</span></br>#{/if}
						</div>
					</li>
					#{set count:count+1/}
					#{/list}
					<input type="hidden" id="discount_rates" name="discount_rates" value="">
				</ul>
				</form>
		</div>
					
					
					
			<!--lihuijun end ------------------------------------------------->
		<div class="back-infor" style="display:none;">
			<form action="@{back.team.TeamCtrl.editTeamRule()}"   method="POST" id="info">
				#{authenticityToken /}
				<input type="hidden" name="imgChanged" value="0"/>
				<h2 class="back-infor-head">
					<span class="left">任务分配额度</span>
					#{rightMng rightId:801002}
					<a href="javascript:void(0);" class="right iconfont finance-edit" data-title="编辑" >&#xe602;</a>
					#{/rightMng}
				</h2>
				<ul class="back-infor-set" style="margin-left: 130px;" >
					<li>
						<span class="lileft" >业务部主任任务额度:</span>
						<div class="liright" > 
							<input type="text" style="width: 50px;" class="width01 iffocus" name="director_quota" value="${settings?.get(common.constants.SettingKey.DIRECTOR_QUOTA)}" />万
						</div>
					</li>
					<li>
						<span class="lileft">业务部经理任务额度:</span>
						<div class="liright">
							<input type="text" class="width01 iffocus" style="width: 50px;" name="director_manager_quota" value="${settings?.get(common.constants.SettingKey.DIRECTOR_MANAGER_QUOTA)}" />万
						</div>
					</li>
					<li>
					
						<span class="lileft">拆标比例:</span>
						<div class="liright">
							<input type="text" class="width01 iffocus" style="width: 50px;" name="standard_bid" value="${settings?.get(common.constants.SettingKey.STANDARD_BID)}" />%
						</div>
					</li>
				</ul>
				</form>
		</div>
		<div class="back-infor" style="display:none;">
			<form action="@{back.team.TeamCtrl.editTeamRule()}" method="POST" id="dire">
				#{authenticityToken /}
				<h2 class="back-infor-head">
					<span class="left">业务室主任团队提成设置</span>
					<a href="javascript:void(0);" class="right iconfont finance-edit" data-title="编辑" >&#xe602;</a>
				</h2>
				<ul class="back-infor-set" >
					    <input type="hidden" name="director_commission" id="director_commission" value="${settings?.get(common.constants.SettingKey.DIRECTOR_COMMISSION)}">
						<li>
						<div class="liright">
						 <input type="hidden" class="width01 iffocus" style="width: 50px;" id="direMinAmount1" name="direMinAmount1" value="0" /> 低于<input type="text" style="width: 50px;" class="width01 iffocus" name="direMaxAmount1" id="direMaxAmount1" value="${lists1?.get(0).maxAmount}" />万:提成=团队理财总金额的<input type="text" name="direAmount1" id="direAmount1" style="width: 50px;" class="width01 iffocus" value="${lists1?.get(0).amount}" />%
						</div>
					</li>
					<li>
						<div class="liright">
						 <input type="text" style="width: 50px;" class="width01 iffocus" id="direMinAmount2" name="direMinAmount2" value="${lists1?.get(1).minAmount}" />万~~<input type="text" name="direMaxAmount2" id="direMaxAmount2" style="width: 50px;"  class="width01 iffocus" value="${lists1?.get(1).maxAmount}" />万:提成=团队理财总金额的<input type="text" style="width: 50px;" class="width01 iffocus" name="direAmount2" id="direAmount2" value="${lists1?.get(1).amount}" />%
						</div>
					</li>
					<li>
						<div class="liright">
						 <input type="text" class="width01 iffocus" style="width: 50px;" id="direMinAmount3" name="direMinAmount3" value="${lists1?.get(2).minAmount}" />万~~<input type="text" style="width: 50px;" class="width01 iffocus" name="direMaxAmount3" id="direMaxAmount3" value="${lists1?.get(2).maxAmount}" />万:提成=团队理财总金额的<input type="text" style="width: 50px;" class="width01 iffocus" name="direAmount3" id="direAmount3" value="${lists1?.get(2).amount}" />%
						</div>
					</li>
				</ul>
			</form>
		</div>
		<!--lihuijun  begin  -------------------------------------------------------------------->
		<div class="back-infor">
				<form action="@{back.team.TeamCtrl.editTeamRule()}" method="POST" id="personal">
					#{authenticityToken /}
					<h2 class="back-infor-head">
						<span class="left">个人推广理财提成点</span> <a href="javascript:void(0);" class="right iconfont finance-edit" data-title="编辑">&#xe602;</a>
					</h2>
					<ul class="back-infor-set" id="per">
					<input type="hidden" name="personal_commission" id="personal_commission" value="${settings?.get(common.constants.SettingKey.DIRECTOR_COMMISSION)}"> <span style="margin-left: 700px;"></span><a id="perAdd" style="float: right; margin-right: 100px;display: none" href="javascript:addRow1()"><i class="iconfont">&#xe60f;</i>添加一行</a>
					#{set count:1/}
					#{list lists9, as:'list9'}			
					<li id="00${list9.minAmount}+b" style="width:830px;">
						<div class="liright">
						 <input type="text" class="width01 iffocus" style="width: 50px;" value="${list9.minAmount}"  />万~~<input type="text" style="width: 50px;" class="width01 iffocus" value="${list9.maxAmount}"  />万:提成=推广客户理财总金额的<input type="text" style="width: 50px;" class="width01 iffocus" value="${list9.amount}"  />‱&nbsp;
						 #{if count>2}<span class="delNiu" onclick="delRow1('${list9.minAmount}+b')" style="display:none; cursor: pointer; float: right; ">删除</span></br>#{/if}
						</div>
					</li>
					#{set count:count+1/}
					#{/list}
					</ul>
				</form>
			</div>

		<!--lihuijun end ------------------------------------------------------------------------->
		<div class="back-infor" style="display:none">
			<form action="@{back.team.TeamCtrl.editTeamRule()}" method="POST" id="info2">
				#{authenticityToken /}
				<input type="hidden" name="imgChanged" value="0"/>
				<h2 class="back-infor-head">
					<span class="left">业务部经理团队提成设置</span>
					#{rightMng rightId:801002}
					<a href="javascript:void(0);" class="right iconfont finance-edit" data-title="编辑" >&#xe602;</a>
					#{/rightMng}
				</h2>
				<ul class="back-infor-set">
					<li>
					<input type="hidden" name="director_manager_commission" id="director_manager_commission" >
						<div class="liright">
						<input type="hidden" name="director_manager_commission" id="director_manager_commission" value="${settings?.get(common.constants.SettingKey.DIRECTOR_MANAGER_COMMISSION)}">
						<input type="hidden" class="width01 iffocus" style="width: 50px;" id="serMinAmount1" name="serMinAmount1" value="0" /> 低于<input type="text" style="width: 50px;" class="width01 iffocus" id="serMaxAmount1" name="serMaxAmount1" value="${lists2?.get(0).maxAmount}" />万:提成=团队理财总金额的<input type="text" id="serAmount1" name="serAmount1" style="width: 50px;" class="width01 iffocus" value="${lists2?.get(0).amount}" />%
						</div>
					</li>
					<li>
						<div class="liright">
						 <input type="text" class="width01 iffocus" style="width: 50px;" id="serMinAmount2" name="serMinAmount2" value="${lists2?.get(1).minAmount}" />万~~<input type="text" style="width: 50px;" class="width01 iffocus" id="serMaxAmount2" name="serMaxAmount2" value="${lists2?.get(1).maxAmount}" />万:提成=团队理财总金额的<input type="text" id="serAmount2" name="serAmount2" style="width: 50px;" class="width01 iffocus" value="${lists2?.get(1).amount}" />%
						</div>
					</li>
					<li>
						<div class="liright">
						 <input type="text" class="width01 iffocus" style="width: 50px;" id="serMinAmount3" name="serMinAmount3" value="${lists2?.get(2).minAmount}" />万~~<input type="text" style="width: 50px;" class="width01 iffocus" id="serMaxAmount3" name="serMaxAmount3" value="${lists2?.get(2).maxAmount}" />万:提成=团队理财总金额的<input type="text" id="serAmount3" name="serAmount3" style="width: 50px;" class="width01 iffocus" value="${lists2?.get(2).amount}" />%
						</div>
					</li>
				</ul>
				</form>
		</div>
		<!--lihuijun  begin------------------------------------>
		<!-- <div class="back-infor">
			<form action="@{back.team.TeamCtrl.editTeamRule()}" method="POST" id="info2">
				#{authenticityToken /}
				<input type="hidden" name="imgChanged" value="0"/>
				<h2 class="back-infor-head">
					<span class="left">部门经理团队提成</span>
					#{rightMng rightId:801002}
					<a href="javascript:void(0);" class="right iconfont finance-edit" data-title="编辑" >&#xe602;</a>
					#{/rightMng}
				</h2>
				<ul class="back-infor-set" id="team">
					<li>
					<input type="hidden" name="director_manager_commission" id="director_manager_commission" ><span style="margin-left: 700px;">计算举例说明</span><a style="float: right; margin-right: 100px;" href="javascript:addRow2()"><i class="iconfont">&#xe60f;</i>添加一行</a>
						<div class="liright">
						<input type="hidden" name="director_manager_commission" id="director_manager_commission" value="${settings?.get(common.constants.SettingKey.DIRECTOR_MANAGER_COMMISSION)}">
		
						</div>
					</li>
				</ul>
				</form>
		</div> -->	
		<!--lihuijun end ------------------------------>
		<!--liuyang begin ------------------------------>
		<div class="back-infor">
			<form action="@{back.team.TeamCtrl.editTeamRule()}" method="POST" id="direct">
				#{authenticityToken /}
				<h2 class="back-infor-head">
					<span class="left">部门经理团队提成设置</span>
					<a href="javascript:void(0);" class="right iconfont finance-edit" data-title="编辑" >&#xe602;</a>
				</h2>
				<ul class="back-infor-set" id="team">
					    <input type="hidden" name="business_manager_commission" id="business_manager_commission" value="${settings?.get(common.constants.SettingKey.BUSINESS_MANAGER_COMMISSION)}"><a id="dirAdd" style="float: right; margin-right: 100px;display: none;" href="javascript:addRow2()"><i class="iconfont">&#xe60f;</i>添加一行</a>
					<li>
						<div class="liright">
						 <input type="hidden" class="diremin width01 iffocus" style="width: 50px;" value="0" id="aaaa"/> 低于<input type="text" style="width: 50px;" class="diremax width01 iffocus" value="${lists3?.get(0).maxAmount}" />万:提成=团队理财总金额的<input type="text" style="width: 50px;" class="width01 iffocus diremou" value="${lists3?.get(0).amount}" />‱
						</div>
					</li>
					<li>
						<div class="liright">
						 <input type="text" style="width: 50px;" class="diremin width01 iffocus" value="${lists3?.get(1).minAmount}"  />万~~<input type="text" style="width: 50px;"  class="width01 iffocus diremax" value="${lists3?.get(1).maxAmount}" />万:提成=团队理财总金额的<input type="text" style="width: 50px;" class="width01 iffocus diremou" value="${lists3?.get(1).amount}"  />‱
						</div>
					</li>
					
					#{set count:0/}
					#{list lists3, as:'lists33'}
					#{if count>=2}
					<li id="${lists33.minAmount}+c" style="width:830px;">
						<div class="liright">
						 <input type="text" class="width01 iffocus diremin" style="width: 50px;" value="${lists33.minAmount}"  />万~~<input type="text" style="width: 50px;" class="width01 iffocus diremax" value="${lists33.maxAmount}"  />万:提成=团队理财总金额的<input type="text" style="width: 50px;" class="width01 iffocus diremou" value="${lists33.amount}"  />‱&nbsp;
						  <span class="delLiu" onclick="delRow2('${lists33.minAmount}+c')" style="display:none; cursor: pointer; float: right; ">删除</span></br>
						</div>
					</li>
					#{/if}
					#{set count:count+1/}
					#{/list}
				</ul>
			</form>
		</div>
		<!--liuyang end ------------------------------>
	</div>
</div>
</div>
<!-- 页面js -->
<script type="text/javascript">
	require(["back"],function(back){
		
		//js验证扩展
		require(["validation/validateExt"]);
		//上传功能的js
		require(["ajaxfileupload"]);	

		$(".back-infor").each( function() {
			var that = this, 
			editBtn = $(this).find( ".finance-edit"),
			editText = $(this).find("select,input:not(.easyui-datetimebox),textarea");
			editText.prop("disabled", true);
			$("#autoInvestInput").prop("disabled", false);
			editBtn.click(function() {
				disable = editText.prop("disabled");
				if (disable) {
					editBtn.html("&#xe630;").data("title","保存");
					
					if($("#zslv").has($(this)).length>0){
						$("#zengj").show();
						$(".delZhe").show();
					}
					

					if($("#personal").has($(this)).length>0){
						$("#perAdd").show();
						$(".delNiu").show();
					}
					
					
					if($("#direct").has($(this)).length>0){
						$("#dirAdd").show();
						$(".delLiu").show();
					}
					
					
					$(".titlebox").text( editBtn.data('title'));
					editText.prop("disabled", !disable);
					editText.eq(0).focus();
				} else {
					if($("#zslv").has($(this)).length>0){
						$("#zengj").hide();
						$(".delZhe").hide();
					}
					
					if($("#personal").has($(this)).length>0){
						$("#perAdd").hide();
						$(".delNiu").hide();
					}
					
					if($("#direct").has($(this)).length>0){
						$("#dirAdd").hide();
						$(".delLiu").hide();
					}
					
					/*
					alert(editText.val());
					editBtn.html("&#xe602;").data("title", "编辑");
					$(".titlebox").text( editBtn.data('title'));
					editText.prop("disabled", !disable);
					*/
					
					var infoForm = $(that).children("form[id='info']");
					if(infoForm.eq(0).length != 0){
						infoForm.submit();
					}
					
					var seoForm = $(that).children("form[id='seo']");
					if(seoForm.eq(0).length != 0){
						seoForm.submit();
					}
					
					var perForm = $(that).children("form[id='personal']");
					if(perForm.eq(0).length != 0){
						perForm.submit();
					}
					
					var securityForm = $(that).children("form[id='dire']");
					if(securityForm.eq(0).length != 0){
						securityForm.submit();
					}
						
					var registerCodeForm = $(that).children("form[id='info2']");
					if(registerCodeForm.eq(0).length != 0){
						registerCodeForm.submit();
					}
					
					var registerCodeForm = $(that).children("form[id='zslv']");
					if(registerCodeForm.eq(0).length != 0){
						registerCodeForm.submit();
					}
					
					//部门经理提成
					var businessForm = $(that).children("form[id='direct']");
					if(businessForm.eq(0).length != 0){
						businessForm.submit();
					}
				}
			});
		});
		
		//定位到正版授权的位置 
		#{if flash?.noRegister}
		$("#registerCode_a").click();
		var height = $("body").height()-$(window).height();
		$("html,body").animate({scrollTop: height+132});
		#{/if}
		
		//***********************//
		//基本信息
		$("form[id='info']").validate({
			errorPlacement: function(error, element) {
				error.addClass('back-notice').insertAfter(element);
			},
			rules:{
				"customer_commission":{
					required:true
				},
				"personal_commission":{
					required:true
				},
				"financial_fee":{
					required:true
				},
				"director_quota":{
					required:true
				},
				"director_manager_quota":{
					required:true
				},
				"standard_bid":{
					required:true
				},
				"director_commission":{
					required:true
				},
				"director_commission":{
					required:true
				},
				"director_manager_commission":{
					digits:true
				},
				"business_manager_commission":{
					required:true
				}
			},
			messages:{
			},
			submitHandler:function(form){
				form.submit();
			}
		});
		$("form[id='dire']").validate({
			errorPlacement: function(error, element) {
				error.addClass('back-notice').insertAfter(element);
			},
			rules:{
				"customer_commission":{
					required:true
				},
				"financial_fee":{
					required:true
				},
				"director_quota":{
					required:true
				},
				"director_manager_quota":{
					required:true
				},
				"standard_bid":{
					required:true
				},
				"discount_rates":{
					required:true
				},
				"director_manager_commission":{
					digits:true
				},
				"business_manager_commission":{
					required:true
				}
			},
			messages:{
			},
			submitHandler:function(form){
				  var json1 ="[";
				   for(var i=1;i<=3;i++){
					  var minAmount =$("#direMinAmount"+i).val();
					  var maxAmount =$("#direMaxAmount"+i).val();
					  var amount =$("#direAmount"+i).val();
					  if(i==3){
					  json1 = json1+"{minAmount:"+minAmount+",maxAmount:"+maxAmount+",amount:"+amount+"}";
					  }else{
					  json1 = json1+"{minAmount:"+minAmount+",maxAmount:"+maxAmount+",amount:"+amount+"},";
					  }
				   }
				   json1 = json1+"]";
				   $("#director_commission").val(json1);
				   form.submit();
			}
		});
		
		//liuyang--begin
		$("form[id='direct']").validate({
			errorPlacement: function(error, element) {
				error.addClass('back-notice').insertAfter(element);
			},
			rules:{
				"customer_commission":{
					required:true
				},
				"financial_fee":{
					required:true
				},
				"director_quota":{
					required:true
				},
				"director_manager_quota":{
					required:true
				},
				"standard_bid":{
					required:true
				},
				"director_commission":{
					required:true
				},
				"director_manager_commission":{
					digits:true
				},
				"business_manager_commission":{
					required:true
				}
			},
			messages:{
			},
			submitHandler:function(form){
				  var direMinAmounts = [];
				  var direMaxAmounts = [];
				  var direAmounts = [];
				  $(".diremin").each(function(){
					  direMinAmounts.push($(this).val());
				  });
				  $(".diremax").each(function(){
					  direMaxAmounts.push($(this).val());
				  });
				  $(".diremou").each(function(){
					  direAmounts.push($(this).val());
				  });
				  var json1 ="[";
				   for(var i=0;i<$(".diremou").length;i++){
					   var minAmount = direMinAmounts[i];
					   var maxAmount = direMaxAmounts[i];
					   var amount = direAmounts[i];
					   if(i==$(".diremou").length-1){
					   json1 = json1+"{minAmount:"+minAmount+",maxAmount:"+maxAmount+",amount:"+amount+"}";
					   }else{
					   json1 = json1+"{minAmount:"+minAmount+",maxAmount:"+maxAmount+",amount:"+amount+"},";
					   }
				   }
				   /* for(var i=1;i<=3;i++){
					  var minAmount =$("#direMinAmount"+i).val();
					  var maxAmount =$("#direMaxAmount"+i).val();
					  var amount =$("#direAmount"+i).val();
					  if(i==3){
					  json1 = json1+"{minAmount:"+minAmount+",maxAmount:"+maxAmount+",amount:"+amount+"}";
					  }else{
					  json1 = json1+"{minAmount:"+minAmount+",maxAmount:"+maxAmount+",amount:"+amount+"},";
					  }
				   } */
				   json1 = json1+"]";
				   $("#business_manager_commission").val(json1);
				   if(jiaoYan("direct")==1){
					   alert("请检查输入必须是数字，且小数点后最多两位");
					   $(".delLiu").show();
				   }else{
					   form.submit();
				   }
			}
		});	
		//liuyang--end
		
		//***********************//
		//SEO设置
		$("form[id='seo']").validate({
			errorPlacement: function(error, element) {
				error.addClass('back-notice').insertAfter(element);
			},
			rules:{
				"baidu_code":{
					required:true,
					maxlength:1024
				},
				"seo_title":{
					maxlength:1024
				},
				"seo_description":{
					maxlength:1024
				},
				"seo_keywords":{
					maxlength:1024
				}
			},
			submitHandler:function(form){
			  var json1 ="[";
			   for(var i=1;i<=6;i++){
				  var minAmount =$("#minAmount"+i).val();
				  var maxAmount =$("#maxAmount"+i).val();
				  var amount =$("#amount"+i).val();
				  if(i==6){
				  json1 = json1+"{minAmount:"+minAmount+",maxAmount:"+maxAmount+",amount:"+amount+"}";
				  }else{
				  json1 = json1+"{minAmount:"+minAmount+",maxAmount:"+maxAmount+",amount:"+amount+"},";
				  }
			   }
			   json1 = json1+"]";
			   $("#customer_commission").val(json1);
			   form.submit();
			}
		});
		
		
		//***********************//
		$("form[id='info2']").validate({
			errorPlacement: function(error, element) {
				error.addClass('back-notice').insertAfter(element);
			},
			rules:{
				"register_code":{
					required:true,
					rangelength:[1,128]
				}
			},
			messages:{
				"register_code":{
					required:"请输入正版授权号"
				}
			},
			submitHandler:function(form){
				  var json1 ="[";
				   for(var i=1;i<=3;i++){
					  var minAmount =$("#serMinAmount"+i).val();
					  var maxAmount =$("#serMaxAmount"+i).val();
					  var amount =$("#serAmount"+i).val();
					  if(i==3){
					  json1 = json1+"{minAmount:"+minAmount+",maxAmount:"+maxAmount+",amount:"+amount+"}";
					  }else{
					  json1 = json1+"{minAmount:"+minAmount+",maxAmount:"+maxAmount+",amount:"+amount+"},";
					  }
				   }
				   json1 = json1+"]";
				   $("#director_manager_commission").val(json1);
				   form.submit();
				}
		});
		
		//******个人推广提成******niu*****//
		$("form[id='personal']").validate({
			errorPlacement: function(error, element) {
				error.addClass('back-notice').insertAfter(element);
			},
			rules:{
				"baidu_code":{
					required:true,
					maxlength:1024
				},
				"personal_title":{
					maxlength:1024
				},
				"personal_description":{
					maxlength:1024
				},
				"personal_keywords":{
					maxlength:1024
				}
			},
			submitHandler:function(form){
				
				var inputArr=[];
				var minAmount=[];
				var maxAmount=[];
				var perAmount=[];
				
				inputArr = $("#per input");

				for (var i=1; i<inputArr.length; i=i+3) {
					minAmount.push($(inputArr[i]).val());
					maxAmount.push($(inputArr[i+1]).val()); ;
					perAmount.push($(inputArr[i+2]).val()); ;
				}
			
				var json1 ="[";
				   for(var i=0;i<minAmount.length;i++){
						 
					   if(i==minAmount.length-1){
							  json1 = json1+"{minAmount:"+minAmount[i]+",maxAmount:"+maxAmount[i]+",amount:"+perAmount[i]+"}";
						}else{
							  json1 = json1+"{minAmount:"+minAmount[i]+",maxAmount:"+maxAmount[i]+",amount:"+perAmount[i]+"},";
						}
					 }  
					   json1 = json1+"]";
					   $("#personal_commission").val(json1);
					   if(jiaoYan("personal")==1){
						   alert("请检查输入必须是数字，且小数点后最多两位");
						   $(".delNiu").show();
					   }else{
						   form.submit();
					   }
			} 
		});
		
		
		//lvweihuan--begin
		$("form[id='zslv']").validate({
				errorPlacement: function(error, element) {
					error.addClass('back-notice').insertAfter(element);
				},
				rules:{
					"register_code":{
						required:true,
						rangelength:[1,128]
					}
				},
				messages:{
					"register_code":{
						required:"请输入正版授权号"
					}
				},
				submitHandler:function(form){
					var qixians=[];
					var zhesuans=[];
					$(".qixian").each(function(){
						qixians.push($(this).val());
					});
					$(".zhesuan").each(function(){
						zhesuans.push($(this).val());
					});
					var json1 ="[";
					   for(var i=0;i<$(".qixian").length;i++){
							 var timeLimit =qixians[i];
							 var discountRate =zhesuans[i];
							 if(i==$(".qixian").length-1){
								 json1 = json1+"{timeLimit:"+timeLimit+",discountRate:"+discountRate+"}"; 
							 }else{
								 json1 = json1+"{timeLimit:"+timeLimit+",discountRate:"+discountRate+"},"; 
							 }
						 }  
						   json1 = json1+"]";
						   $("#discount_rates").val(json1);
						   if(jiaoYan("zslv")==1){
							   alert("请检查输入必须是数字，且小数点后最多两位");
							   $(".delZhe").show();
							 
						   }else{
							   form.submit();
						   }
						   
					}
			});
		//lvweihuan--end
	});
	
	
 	function uploadICON(){
 		
 		var fileId = "platform_icon_filename";
		var file = $("#" + fileId).val();
		var pos = file.lastIndexOf("\\");
		var fileName = file.substring(pos + 1);
		
		$.ajaxFileUpload({
			url : '@{back.setting.PlateformSettingCtrl.uploadPlatformImage()}',
			secureuri : false,
			fileElementId : fileId,
			data:{
				"fileName":fileName
			},
			dataType : 'json',
			success : function(result) {
				if(result.code == 1){
					var data = result.obj;
					$("img[name='platform_icon_filename']").attr("src", data.staticFileName);
					$("input[name='platform_icon_filename']").val(data.staticFileName);
					
					$("#resolutionshow2").html(data.imageResolution+", ");
					$("#formatshow2").html(data.fileSuffix+", ");
					$("#sizeshow2").html(data.size+"kb");
				
					$("#picNew2").css({ "display": "block"});
				} else {
					alert(result.msg);
				}
			}
		})
	} 
 	
 	function updateIsAutoInvestShow(obj) {
		var flag = false;
		if(obj.is(':checked')){
				 flag = true;
		}
		$.ajax({
				url : "@{back.setting.PlateformSettingCtrl.updateIsAutoInvestShow()}",
				type : "POST",
				data : {
					"flag" : flag
				},
				dataType:"json",
				success : function(result) {
					var flag = interceptorCheck(result);
					if(!flag){
						return;
					}
					if(result.code < 1){
						alert(result.msg);
					} else {
						weakDialog(result.msg);
					}
				}
		});
	}
 	/*lihuijun  begin=============================================*/
 	 var i=100000;
  function addRow(){
 	
	  document.getElementById('annualRate').innerHTML+=

		 '<li id="'+i+'" style="width:830px;"><div class="liright"><input type="text" style="width: 20px;" class="qixian width01 iffocus" value="" />个月<input type="text" style="width: 35px;margin-left: 35px" class="zhesuan width01 iffocus" value="" />%<span style="width: 200px;margin-left: 357px" class="width01 iffocus"/></span>&nbsp;<span class="delZhe" onclick="delRow('+i+')" style=" cursor: pointer; float: right; ">删除</span></div></li>'
		 i++;

  }
 function delRow(liId){

	 if(confirm("确认删除吗？",function(){
		 var obj=document.getElementById(liId);
		 document.getElementById('annualRate').removeChild(obj);
	}));

 }

 function addRow1(){
	 document.getElementById('per').innerHTML+=
		 '<li id="'+i+'" style="width:830px;"><div class="liright"><input type="text" style="width: 50px;" class="width01 iffocus" id="d'+i+'" name="direMinAmount2" value="" />万~~<input type="text" name="direMaxAmount2" id="e'+i+'" style="width: 50px;"  class="width01 iffocus" value="" />万:提成=推广客户理财总金额的<input type="text" style="width: 50px;" class="width01 iffocus" name="direAmount2" id="f'+i+'" value="" />‱<span style="width: 200px;margin-left: 70px" class="width01 iffocus" name="amount2" id="l'+i+'" /></span>&nbsp;<span class="delNiu" onclick="delRow1('+i+')" style=" cursor: pointer; float: right; ">删除</span></div></li>'
		 i++;
 }
 function delRow1(liId){
	 if(confirm("确认删除吗？",function(){
		 var obj=document.getElementById(liId);
		 document.getElementById('per').removeChild(obj);
	}));

 }
 function addRow2(){
	
	 document.getElementById('team').innerHTML+=
		 '<li id="'+i+'" style="width:830px;"><div class="liright"><input type="text" style="width: 50px;" class="diremin width01 iffocus diremin" value=""  />万~~<input type="text" style="width: 50px;"  class="width01 iffocus diremax" value=""  />万:提成=团队理财总金额的<input type="text" style="width: 50px;" class="width01 iffocus diremou" value=""  />‱<span style="width: 200px;margin-left: 70px" class="width01 iffocus" /></span>&nbsp; <span class="delLiu" onclick="delRow2('+i+')" style=" cursor: pointer; float: right; ">删除</span></div></li>'
		 i++;
 }
 function delRow2(liId){

	 if(confirm("确认删除吗？",function(){
		 var obj=document.getElementById(liId);
		 document.getElementById('team').removeChild(obj);
	}));

 }
 /*lihuijun  end============================================= */
 //lvweihuan

 var reglv=/^\d+(\.\d{2}|\.\d{1})?$/;

 function jiaoYan(id){
	 var thisInputs=[];
	 $("input[type=text]",document.forms[id]).each(function(){
		  thisInputs.push($(this).val());
	 });
	 var flag=0;
	 for(var i=0;i<thisInputs.length;i++){
		 if(!reglv.test(thisInputs[i])){
			 flag=1;
		 }
	 }
	 return flag;
 }
 //lvweihuan end
</script>

